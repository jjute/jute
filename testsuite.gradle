/*
 * Executes JUnit 5 tests.
 * Test are always run in (one or more) separate JVMs.
 */
test {
    // Clean the old test-results first
    dependsOn cleanTest

    // Specifies that JUnit Platform (a.k.a. JUnit 5)
    // should be used to execute the tests.
    useJUnitPlatform()

    /* Setting the exception format here will allow us to customize the way
     * thrown exceptions are being displayed. By setting it to 'full' we get
     * the best exception format Gradle can handle displayed in our console.
     */
    testLogging {
        exceptionFormat = 'full'
    }

    // Fail the 'test' task on the first test failure
    failFast = false

    doFirst {
        logger.debug("Running project Unit Tests...")
    }
    // listen to events in the test execution lifecycle
    beforeTest { descriptor ->
        logger.lifecycle("Running test: $descriptor")
    }
    doLast {
        logger.quiet("Finished running Unit Tests.")
    }
}